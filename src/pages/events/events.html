<ion-header>
  <ion-navbar color='primary'>
    <ion-title>Dashboard</ion-title>
  </ion-navbar>
</ion-header>

<ion-content parallax-header>
  <ion-refresher pullMax="400" pullMin="60" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <!-- <div class="cover header-image">
    <h1 class="events">EVENTS</h1>
  </div> -->
  <div class="main-content">
    <ion-item>
      Upcoming Classes
      <ion-icon item-left name='clock'></ion-icon>
    </ion-item>

    <ng-container *ngIf="isLoading">
      <ion-item *ngFor="let i of numOfSkeletons">
        <skeleton-item height="137px" width="100%"></skeleton-item>
      </ion-item>
    </ng-container>

    <ng-template let-classes [ngIf]='upcomingClass$ | async'>
      <ion-card *ngFor='let c of classes'>
        <ion-card-header>
          {{ c.SUBJECT_CODE }}
        </ion-card-header>
        <ion-card-content>
          <ion-label no-margin>
            <ion-icon padding-right name="time"></ion-icon>
            <b>{{ c.TIME_FROM }}</b> -
            <b>{{ c.TIME_TO }}</b>
          </ion-label>
          <ion-label no-margin>
            <ion-icon padding-right name="locate"></ion-icon>
            {{ c.ROOM }} â”‚ {{ c.LOCATION }}
          </ion-label>
          <ion-label no-margin>
            <a (click)="openStaffDirectoryInfo(c.SAMACCOUNTNAME)">
              <ion-icon padding-right name="contact"></ion-icon>
              {{ c.LECTURER_NAME }}
            </a>
          </ion-label>
        </ion-card-content>
      </ion-card>
    </ng-template>
    <ng-template [ngIf]='!classes'>
      <ion-card padding>
        <ion-note>You have no upcoming classes for today</ion-note>
      </ion-card>
    </ng-template>

    <ion-item>
      Upcoming Holiday
      <ion-icon item-left name='calendar'></ion-icon>
    </ion-item>
    <ng-template [ngIf]="holidays " [ngIfElse]='noholidays'>
      <ion-card>
        <ion-item>
          {{ holidays.holiday_name }}
          <ion-note *ngIf='date' item-right> {{ date | date}}</ion-note>
        </ion-item>
        <ion-card-content>
          {{ holidays.holiday_description }}
        </ion-card-content>
      </ion-card>
    </ng-template>
    <ng-template #noholidays>
      <ion-card padding>
        <ion-note>You have no upcoming holidays</ion-note>
      </ion-card>
    </ng-template>

    <ion-item>
      Upcoming Exams
      <ion-icon item-left name='book'></ion-icon>
    </ion-item>
    <ng-template let-exam [ngIf]='exam$ | async | nextExams'>
      <ion-card tappable *ngFor='let e of exam' (click)='openExamPage()'>
        <ion-item>{{ e.module }}
        </ion-item>
        <ion-item>
          <ion-note> {{ e.since | date:'medium'}}</ion-note>
        </ion-item>
      </ion-card>
    </ng-template>
    <ng-template [ngIf]='!exam'>
      <ion-card padding>
        <ion-note>You have no upcoming exams</ion-note>
      </ion-card>
    </ng-template>

    <ion-item>
      Total Overdue Fee
      <ion-icon item-left name='cash'></ion-icon>
    </ion-item>
    <ion-card>
      <chart margin-top [type]="type[0]" [data]="data" [options]="options[0]"></chart>
    </ion-card>

    <ion-item>
      GPA per Intake
      <ion-icon item-left name='checkbox'></ion-icon>
    </ion-item>
    <ion-card>
      <chart margin-top *ngIf="barChartData" [type]="type[1]" [data]="barChartData" [options]="options[1]"></chart>
    </ion-card>

    <ion-item *ngIf='studentIntake'>
      {{ studentIntake }} - Attendance
      <ion-icon item-left name='alarm'></ion-icon>
    </ion-item>
    <ion-card class="attendance-card">
      <circle-progress [percent]="percent" innerStrokeColor='#d7d8da' [outerStrokeColor]="percent !== 0 ? averageColor : '#d7d8da'"
      ></circle-progress>
    </ion-card>
  </div>
</ion-content>
